{% extends "template.html" %}

{% block content %}
<h2>Profil uživatele {{ profile.name }}</h2>

<form action="{{ url_for('upload_profile_picture') }}" method="post" enctype="multipart/form-data" style="margin-top: 20px;">
    <label for="profile_image">Nahrát profilovou fotku:</label>
    <input type="file" id="profile_image" name="profile_image" accept="image/*">
    <button type="submit">Nahrát</button>
</form>

<ul>
    <li>Věk: {{ profile.age }}</li>
    <li>Záliby:
        <ul>
            {% if profile.hobbies %}
                {% for hobby in profile.hobbies %}
                    <li>{{ hobby }}</li>
                {% endfor %}
            {% else %}
                <li>Žádné záliby</li>
            {% endif %}
        </ul>
    </li>
    <li>Body sluníček: {{ profile.sun_points }}</li>
    <li>Body ohýnku: {{ profile.fire_points }}</li>
</ul>

{% if profile.profile_image %}
    <img src="{{ url_for('static', filename='uploads/' ~ profile.profile_image) }}" alt="Profilová fotka" style="width: 100px; height: 100px; float: right;">
{% endif %}

<!-- Odkaz na úpravu profilu -->
{% if session.get("username") == profile.name %}
    <a href="{{ url_for('edit_profile') }}" class="btn btn-primary" style="margin-top: 20px;">Upravit profil</a>
{% endif %}


<!-- Tlačítko pro odhlášení -->
{% if session.get("username") == profile.name %}
    <form action="{{ url_for('logout') }}" method="post" style="margin-top: 20px;">
        <button type="submit">Odhlásit se</button>
    </form>
{% endif %}

<h3>Probíhající výzvy</h3>
{% if ongoing_challenges %}

<ul>
    {% for challenge in ongoing_challenges %}
        <li>
            <a href="{{ url_for('challenge_details', title=challenge.title) }}">{{ challenge.title }}</a> - končí {{ challenge.end_date }}
        </li>
    {% endfor %}
</ul>
{% else %}
    <p>Momentálně se neúčastníte žádných výzev.</p>
{% endif %}


<h3>Splněné výzvy</h3>
{% if completed_challenges %}

<ul>
    {% for challenge in completed_challenges %}
        <li>
            <a href="{{ url_for('challenge_details', title=challenge.title) }}">{{ challenge.title }}</a> - splněno<br>
            Výsledek: {{ challenge.result }}<br>
            Komentář: {{ challenge.comment }}
        </li>
    {% endfor %}
</ul>
{% else %}
    <p>Nemáte žádné splněné výzvy.</p>
{% endif %}

{% if session.get("is_admin") %}
    <a href="{{ url_for('admin') }}" class="btn btn-primary" style="margin-top: 20px;">Přejít na Admin stránku</a>
{% endif %}
{% endblock %}

